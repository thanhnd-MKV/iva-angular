<div class="sidebar-wrapper">
  <nav class="sidebar" [class.close]="!isSidebarOpened" id="sidebar">
    
    <ul>
      <li class="header-navbar">
        <!-- Logo khi menu mở -->
        <div class="logo-open" *ngIf="isSidebarOpened">
          <img [src]="logoPath" alt="MK Vision" class="logo-image">
        </div>
        
        <!-- Logo khi menu đóng (clickable) -->
        <div class="logo-closed" *ngIf="!isSidebarOpened" (click)="toggleSidebar()">
          <img [src]="logoPath" alt="MK Vision" class="logo-image-small">
        </div>
        
        <!-- Button toggle chỉ hiện khi menu mở -->
        <button (click)="toggleSidebar()" 
                id="toggle-btn" 
                [class.rotate]="!isSidebarOpened"
                *ngIf="isSidebarOpened">
          <mat-icon>keyboard_double_arrow_left</mat-icon>
        </button>
      </li>
      
      <li>
        <a routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
          <img src="assets/icon/Home-icon.svg" alt="Dashboard" class="menu-icon">
          <span>Trang chủ</span>
        </a>
      </li>
      
      <li>
        <button (click)="toggleSubMenu($event)" 
                (mouseenter)="isSidebarOpened ? null : onMenuHover($event, true)"
                (mouseleave)="isSidebarOpened ? null : onMenuHover($event, false)"
                class="dropdown-btn" 
                [class.rotate]="cameraSubMenuOpen"
                [class.active]="isCameraRouteActive()">
          <img src="assets/icon/id-icon.svg" alt="Camera" class="menu-icon">
          <span>Camera</span>
          <mat-icon>keyboard_arrow_down</mat-icon>
        </button>
        <ul class="sub-menu" [class.show]="cameraSubMenuOpen"
            (mouseenter)="isSidebarOpened ? null : onSubmenuHover($event, true)"
            (mouseleave)="isSidebarOpened ? null : onSubmenuHover($event, false)">
          <div>
            <li>
              <a routerLink="/camera/list" routerLinkActive="active" (click)="closeAllSubMenus()">
                Danh sách Camera
              </a>
            </li>
            <li>
              <a routerLink="/camera/setting" routerLinkActive="active" (click)="closeAllSubMenus()">
                Cài đặt Camera
              </a>
            </li>
          </div>
        </ul>
      </li>
      
      <li>
        <button (click)="toggleSubMenu($event)" 
                (mouseenter)="isSidebarOpened ? null : onMenuHover($event, true)"
                (mouseleave)="isSidebarOpened ? null : onMenuHover($event, false)"
                class="dropdown-btn" 
                [class.rotate]="eventSubMenuOpen"
                [class.active]="isEventRouteActive()">
          <img src="assets/icon/Note-icon.svg" alt="Event" class="menu-icon">
          <span>Quản lý sự kiện</span>
          <mat-icon>keyboard_arrow_down</mat-icon>
        </button>
        <ul class="sub-menu" [class.show]="eventSubMenuOpen"
            (mouseenter)="isSidebarOpened ? null : onSubmenuHover($event, true)"
            (mouseleave)="isSidebarOpened ? null : onSubmenuHover($event, false)">
          <div>
            <li>
              <a routerLink="/event/all" routerLinkActive="active" (click)="closeAllSubMenus()">
                Tất cả sự kiện
              </a>
            </li>
            <li>
              <a routerLink="/event/person" routerLinkActive="active" (click)="closeAllSubMenus()">
                Đối tượng người
              </a>
            </li>
            <li>
              <a routerLink="/event/traffic" routerLinkActive="active" (click)="closeAllSubMenus()">
                Giao thông
              </a>
            </li>
            <li>
              <a routerLink="/event/photo-gallery" routerLinkActive="active" (click)="closeAllSubMenus()">
                Thư viện ảnh
              </a>
            </li>
          </div>
        </ul>
      </li>
      
      <li>
        <button (click)="toggleSubMenu($event)" 
                (mouseenter)="isSidebarOpened ? null : onMenuHover($event, true)"
                (mouseleave)="isSidebarOpened ? null : onMenuHover($event, false)"
                class="dropdown-btn" 
                [class.rotate]="statsSubMenuOpen"
                [class.active]="isStatsRouteActive()">
          <img src="assets/icon/chart-icon.svg" alt="Statistics" class="menu-icon">
          <span>Thống kê sự kiện</span>
          <mat-icon>keyboard_arrow_down</mat-icon>
        </button>
        <ul class="sub-menu" [class.show]="statsSubMenuOpen"
            (mouseenter)="isSidebarOpened ? null : onSubmenuHover($event, true)"
            (mouseleave)="isSidebarOpened ? null : onSubmenuHover($event, false)">
          <div>
            <li>
              <a routerLink="/thong-ke/person-recognition" routerLinkActive="active" (click)="closeAllSubMenus()">
                Đối tượng nhận diện
              </a>
            </li>
            <li>
              <a routerLink="/thong-ke/entry-exit-flow" routerLinkActive="active" (click)="closeAllSubMenus()">
                Lưu lượng ra vào
              </a>
            </li>
            <li>
              <a routerLink="/thong-ke/traffic-flow" routerLinkActive="active" (click)="closeAllSubMenus()">
                Lưu lượng giao thông
              </a>
            </li>
            <li>
              <a routerLink="/thong-ke/traffic-violation" routerLinkActive="active" (click)="closeAllSubMenus()">
                Vi phạm giao thông
              </a>
            </li>
          </div>
        </ul>
      </li>
      
      <li>
        <a routerLink="/object-management" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
          <img src="assets/icon/id-icon.svg" alt="Object Management" class="menu-icon">
          <span>Quản lý đối tượng</span>
        </a>
      </li>
    </ul>
    
    <div class="user-section">
      <app-user *ngIf="isSidebarOpened"></app-user>
      <app-usermini *ngIf="!isSidebarOpened"></app-usermini>
    </div>
  </nav>

  <div class="content">
    <ng-content></ng-content>
  </div>
</div>