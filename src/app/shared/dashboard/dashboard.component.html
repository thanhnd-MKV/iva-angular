<div class="filter-bar">
  <div class="filter-left">
    <div class="search-box">
      <mat-icon class="search-icon">search</mat-icon>
      <input type="text" placeholder="Tìm kiếm" class="search-input" [(ngModel)]="searchText" (keyup.enter)="onSearch()">
    </div>

    <div class="filter-btn-wrapper">
      <button class="filter-btn time-btn" [class.active]="showTimeDropdown" (click)="toggleTimeDropdown()">
        <mat-icon class="btn-icon">calendar_today</mat-icon>
        <span>{{ getTimeRangeLabel() }}</span>
        <mat-icon class="dropdown-icon">expand_more</mat-icon>
      </button>
      
      <div class="dropdown-menu time-dropdown" *ngIf="showTimeDropdown">
        <div class="dropdown-item" *ngFor="let option of timeOptions" 
             [class.selected]="selectedTimeRange === option.value"
             (click)="selectTimeRange(option.value)">
          {{ option.label }}
        </div>
      </div>
    </div>
    
    <app-date-range-picker 
      *ngIf="selectedTimeRange === 'custom'"
      (dateRangeSelected)="onDateRangeSelected($event)"
      (dateRangeCleared)="onDateRangeCleared()">
    </app-date-range-picker>

    <div class="filter-btn-wrapper">
      <button class="filter-btn camera-btn" [class.active]="showCameraDropdown || selectedCamera !== ''" (click)="toggleCameraDropdown()">
        <mat-icon class="btn-icon">videocam</mat-icon>
        <span>{{ getCameraLabel() }}</span>
        <mat-icon class="dropdown-icon">expand_more</mat-icon>
      </button>
      
      <div class="dropdown-menu camera-dropdown" *ngIf="showCameraDropdown">
        <div class="dropdown-item" *ngFor="let option of cameraOptions"
             [class.selected]="selectedCamera === option.value"
             (click)="selectCamera(option.value)">
          {{ option.label }}
        </div>
      </div>
    </div>

    <button class="filter-btn clear-btn" (click)="clearFilters()" *ngIf="hasActiveFilters()">
      <mat-icon class="btn-icon">close</mat-icon>
      <span>Xóa bộ lọc</span>
    </button>
  </div>
  
  <div class="filter-right">
  </div>
</div>

<div class="dashboard-container">
  <!-- Map Section -->
  <div class="map-section">
    <div class="map-card">
      <h3 class="chart-title">Thống kê vi phạm theo Camera</h3>
      <div class="map-wrapper">
        <app-traffic-flow-map [cameraLocations]="cameraLocations"></app-traffic-flow-map>
      </div>
    </div>
  </div>
</div>
